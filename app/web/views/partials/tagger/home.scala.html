
<div ui-modal class="create-collection-pane" ng-model="uiState.showCollectionsPane" style="padding: 20px" ng-controller="CreateCollection" ng-click="paneClicked()">
    <div class="modal-header create-collections">
        <span class="close-window-button" style="display: inline-block;" ng-click="uiState.showCollectionsPane = false"></span>
        <div class="header">
            <button type="button" class="btn btn-default" ng-click="viewState = 'org'" ng-disabled="viewState == 'org'">{{orgName}} Collections</button>
            <button type="button" class="btn btn-default" ng-click="viewState = 'shared'" ng-disabled="viewState == 'shared'">Shared Collections</button>
        </div>
    </div>
    <div ng-show="viewState == 'org'">
        <div class="header-holder">
            <!-- org collections -->
            <table class="table header">
            <thead>
                    <th class="collection-label">Collection</th>
                    <th># of items</th>
                    <th></th>
                    <th></th>
                </thead>
            </table>
        </div>

        <div class="scrollable">
            <table class="table table-striped">
                <tbody>
                <tr ng-repeat="collection in collections">
                    <td class="collection-label">

                        <div content-editable
                             content-id="{{collection.id}}"
                             ng-model="collection.name"
                             validate-change="onRenameCollection(text, id, callback)">
                        </div>
                    </td>
                    <td>{{collection.itemCount}}</td>
                    <td>
                        <span ng-show="collection.itemCount == 0"><a ng-click="deleteCollection(collection.id)">delete</a></span>
                    </td>
                    <td>
                        <span><a ng-click="openCollectionSharing(collection)">share...</a></span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>



        <div class="footer">
             <input type="text" id="newcollection" ui-keypress="{13:'createCollection(newcolname)'}" placeholder="type collection name..." ng-model="newcolname">
             <button class="btn btn-mini btn-success" ng-click="createCollection(newcolname)">add</button>
        </div>
        <div class="alert" ng-class="alertClass">{{alertMessage}}</div>
    </div>
    <!-- shared collections -->

    <div ng-show="viewState == 'shared'">
        <div class="header-holder">
            <!-- org collections -->
            <table class="table header">
                <thead>
                <th class="collection-label">Collection</th>
                <th># of items</th>
                <th></th>
                </thead>
            </table>
        </div>

        <div class="scrollable">
            <table class="table table-striped">
                <tbody>
                <tr ng-repeat="collection in sharedCollections | filter:{isPublic:false}">
                    <td class="collection-label">{{collection.name}}</td>
                    <td>{{collection.itemCount}}</td>
                    <td>
                        <span ng-show="collection.enabled"><a ng-click="disableCollection(collection)">disable</a></span>
                        <span ng-show="!collection.enabled"><a ng-click="enableCollection(collection)">enable</a></span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="alert" ng-class="alertClass">{{alertMessage}}</div>
    </div>

    <!-- collection sharing -->

    <div ng-show="viewState == 'collectionSharing'">
        <div class="header-holder">
            <!-- org collections -->
            <table class="table header">
                <thead>
                <th class="collection-label">Collection: {{activeCollection.name}}, Shared with Organizations....</th>
                <th></th>
                <th></th>
                </thead>
            </table>
        </div>

        <div class="scrollable">
            <table class="table table-striped">
                <tbody>
                <tr ng-repeat="org in orgsForSharedCollection">
                    <td class="collection-label">{{org.name}}</td>
                    <td></td>
                    <td>
                        <span></span>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="footer">
            Organization ID: <input type="text" id="sharedOrgIdInput" ui-keypress="{13:'shareCollection(sharedOrgId, activeCollection)'}" placeholder="enter org id..." ng-model="sharedOrgId">
            <button class="btn btn-mini btn-success" ng-click="shareCollection(sharedOrgId, activeCollection)">share</button>
            <button class="btn btn-mini btn-primary" ng-click="viewState = 'org'">cancel</button>
        </div>
        <div class="alert" ng-class="alertClass">{{alertMessage}}</div>
    </div>

</div>
<div ng-class="{'window-up': showPopup}">
    <div class="window-overlay">
        <div class="window" style="top: 50px; display: block;" onclick="var event = arguments[0] || window.event; event.stopPropagation();">
            <a class="focus-dummy" href="#"></a>
            <div class="window-wrapper clearfix" style="">
                <div class="clearfix">
                    <div id="preloader" class="preloader" style="height: 600px">
                    </div>
                    <span profile-player="" id='player' style="display: block; width: 100%; min-height: 400px" item-id="{{previewingId}}" on-item-load="onItemLoad()" style='display: none'/>
                </div>
            </div>
        </div>
    </div>
</div>

        <div class="navbar-filter navbar-filter-top" ng-controller="tagger.SubNavController">

        <table class="filter-nav">
        <tbody>
        <tr>
            <td>
                <span multi-select
                  multi-get-title="getCollectionTitle"
                  multi-options="sortedCollections"
                  multi-change="search"
                  multi-uid="id"
                  multi-model="searchParams.collection">
                  <div class="summary">
                    <div class="multi-title-text collection"> COLLECTION <span ng-class="{true:'caret',false:'caret-right'}[showChooser]"></span></div>
                    <div class="selected-multi-options collection" ng-bind-html-unsafe="getCollectionSelectedTitle(selected)"></div>
                  </div>

                  <!-- note: we are overriding the default repeater here  - see multi-select.coffee in corespring-ng-components for more info -->
                  <div class="repeater" style="min-width: 200px;">
                      <div ng-repeat="o in options">
                          <b>{{o.name}}</b> <br/>
                          <span ng-show="o.collections.length == 0">You don't have any collections yet</span>
                          <div ng-repeat="c in o.collections">
                              <span ng-show="c.enabled">
                                  <input type="checkbox" ng-model="selectedArr[c.${uidKey}]" ng-click="toggleItem(c)"/>
                                  {{c.name}} <span ng-show="c.isPublic">(public)</span>
                              </span>
                          </div>

                      </div>
                      <a ng-click="clear()">clear</a>
                  </div>
                </span>
            </td>
            <td class="nav-vr"><div></div></td>
            <td>
                <span multi-select
                  multi-get-title="getContributorTitle"
                  multi-options="contributors"
                  multi-change="search"
                  multi-uid="name"
                  multi-model="searchParams.contributor">
                  <div class="summary">
                    <div class="multi-title-text collection"> CONTRIBUTOR <span ng-class="{true:'caret',false:'caret-right'}[showChooser]"></span></div>
                    <div class="selected-multi-options collection" ng-bind-html-unsafe="getContributorSelectedTitle(selected)"></div>
                  </div>
                </span>
            </td>
            <td class="nav-vr"><div></div></td>
            <td class="grade-level-chooser">
                <span multi-select
                  multi-get-title="getTitle"
                  multi-get-selected-title="getSelectedTitle"
                  multi-options="gradeLevelDataProvider"
                  multi-change="search"
                  multi-model="searchParams.gradeLevel">
                  <div class="summary">
                    <div class="multi-title-text grade-level">GRADE LEVEL<span ng-class="{true:'caret',false:'caret-right'}[showChooser]"></span></div>
                    <div class="selected-multi-options grade-level" ng-bind-html-unsafe="getSelectedTitle(selected)"></div>
                  </div>
                </span>
            </td>
            <td class="nav-vr"><div></div></td>
            <td>
                <span multi-select
                  multi-get-title="getLabel"
                  multi-get-selected-title="getSelectedTitle"
                  multi-options="flatItemTypeDataProvided"
                  multi-change="search"
                  multi-model="searchParams.itemType">
                  <div class="summary">
                    <div class="multi-title-text grade-level">TYPE<span ng-class="{true:'caret',false:'caret-right'}[showChooser]"></span></div>
                    <div class="selected-multi-options grade-level" ng-bind-html-unsafe="getSelectedTitle(selected)"></div>
                  </div>
                </span>
            </td>
            <td class="nav-vr"><div></div></td>
            <td>
                <span multi-select
                  multi-get-title="getLabel"
                  multi-options="statuses"
                  multi-change="search"
                  multi-model="searchParams.statuses">
                  <div class="summary">
                    <div class="multi-title-text collection"> WORKFLOW <span ng-class="{true:'caret',false:'caret-right'}[showChooser]"></span></div>
                    <div class="selected-multi-options collection" ng-bind-html-unsafe="getSelectedTitle(selected)"></div>
                  </div>
                </span>
            </td>
            <td class="nav-vr"><div></div></td>
            <td>
              <div class="input-append">
                <input placeholder="Search" ng-model="searchParams.searchText" ng-change="lazySearch()" class="span3 form-control" id="appendedInputButtons" type="text"><span class="add-on"><i class="fa fa-search"></i></span>
               </div>
            </td>
            <td>
                <span class="nav" style="padding-left: 10px; padding-top: 10px;">
                  <a style="text-decoration: underline;" ng-click="uiState.showCollectionsPane = !uiState.showCollectionsPane">Manage Collections</a>
                </span>
            </td>
        </tr>
        </tbody>
        </table>
    </div>

<div class="row" style="padding-top: 90px">
    <div class="container-fluid" when-scrolled="loadMore()" watch="itemDataCollection">
        <table class="item-list table content-sort" style="margin: 0 auto; margin-top:20px; width:95%;">
            <thead>
            <tr>
                <th sort-column-header field="preview"></th>
                <th sort-column-header field="title" width="200">Title</th>
                <th sort-column-header field="description" width="300">Description</th>
                <th width="200">Subject</th>
                <th width="100" sort-column-header field="gradeLevel">Grade</th>
                <th sort-column-header field="itemType">Item Type</th>
                <th>Standard(s)</th>
                <th width="100" sort-column-header field="contributor">Source</th>
                <!-- <th sort-column-header field="published">Status</th> -->
                <th width="200" sort-column-header>Editing</th>
                <th sort-column-header></th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="item in items" style="cursor: pointer;">
                <td><a class="btn btn-warning btn-small" ng-click="launchCatalogView()">Preview</a>
                    
                </td>
                <td>
                    <item-status class="pull-left" item="item" get-number-of-sessions="getNumberOfSessions(item.id)"></item-status>
                    <a ui-jq="tooltip"
                       ui-options="{title: buildTitleTooltip(item.title)}">{{buildTitleEllipsis(item.title)}}</a>
                </td>
                <td><a ui-jq="tooltip"
                       ui-options="{title: buildDescriptionTooltip(item.description)}">{{buildDescriptionEllipsis(item.description)}}</a>
               </td>
                <td>{{getPrimarySubjectLabel(item.primarySubject)}}</td>
                <td>{{createGradeLevelString(item.gradeLevel)}} </td>
                <td>{{showItemType(item)}}</td>
                <td>
                    <a ui-jq="tooltip"
                       ui-options="{title: buildStandardTooltip(item.standards)}">{{buildStandardLabel(item.standards)}}</a>
                </td>
                <td>{{getAuthorAbbreviation(item.contributor)}}</td>
                <!-- <td>
                  <item-status item="item" get-number-of-sessions="getNumberOfSessions(item.id)"></item-status>
                </td> -->
                <td>
                  <item-edit-button
                    item="item"
                    user-name="userName"
                    org="org"
                    org-drafts="orgDrafts"
                    edit="edit(item)"
                    publish="publish(item)"
                    clone-item="cloneItem(item)" ></item-edit-button>
                </td>
                <td style="vertical-align: middle">

                  <ul class="nav pills">
                    <li class="dropdown" id="menu1">
                      <button class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#menu1">
                        Dropdown
                        <b class="caret"></b>
                      </button>
                      <ul class="dropdown-menu">
                        <li><a href="#">Action</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li class="divider"></li>
                        <li><item-delete-button
                    item="item"
                    org="org"
                    user-name="userName"
                    org-drafts="orgDrafts"
                    delete-item="deleteItem(item)"
                    delete-draft="$parent.deleteDraft">Delete</item-delete-button></li>
                      </ul>
                    </li>
                  </ul>


                  <item-delete-button
                    item="item"
                    org="org"
                    user-name="userName"
                    org-drafts="orgDrafts"
                    delete-item="deleteItem(item)"
                    delete-draft="$parent.deleteDraft">Delete</item-delete-button>
                  </td>
            </tr>
            </tbody>
        </table>

    </div>
</div>