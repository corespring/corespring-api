@(templates: List[_root_.web.models.QtiTemplate], dbServer : String, dbName : String, username:String, jsonString:String, accessToken:String)

@htmlSafe(s:String) = @{
    var out = s.replace("\\", "\\\\")
    out = out.replace("\n", "\\n")
    out = out.replace("\"", "\\\"")
    Html(out)
}

<!DOCTYPE html>
<html lang="en" ng-app="tagger" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <title>@dbName | Corespring</title>
    <meta name="description" content="CoreSpring Content Tagger"/>
    <link href='http://fonts.googleapis.com/css?family=Ubuntu:300,400,500,700' rel='stylesheet' type='text/css'>

    @head.coreJs()
    @head.bootstrap()
    @head.angular()
    @head.select2()
    @head.aceEditor()
    @head.taggerApp()

    <link href="/assets/stylesheets/app.css" rel="stylesheet"/>

    <script src="/assets/js/vendor/corespring-ng-components/corespring-ng-components.js" type="text/javascript" ></script>

    <script type="text/javascript">

        window.fieldValues = @Html(jsonString);

        //init the bootstrap dropdowns - TODO: make this a directive?
        $('.dropdown-toggle').dropdown();

        /**
         * Templates Service - provides some xml templates for common types.
         */
        var templatesService = angular.module('templates', []);

        templatesService.factory('NewItemTemplates', function () {
            var data = {};

            data["blank"] = {
                label: "blank",
                xmlData: ""
            }

            @templates.map{ template =>
             data["@template.code"] = {
                label: "@template.label",
                xmlData: "@htmlSafe(template.xmlData)"
             }
            }
            return data;
        });

        //Set the AccessToken service for the logged in user.
        angular.module('tagger.services')
           .factory('AccessToken', [ function () {
              return { token: "@accessToken" };
            }]
        );

    </script>

</head>
<body>

    @mainNav(username)

    <div ng-view class=""></div>
</body>
</html>
